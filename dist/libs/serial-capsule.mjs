import e from"msgpack-lite";import{verifyAudioFormat as t}from"./audio-verify.mjs";import{verifyVideoFormat as n}from"./video-verify.mjs";function i(i){if("application/json"===i.mime||"text/plain"===i.mime)return e.encode(i);let o=!1;const m=new DataView(i.content instanceof ArrayBuffer?i.content:i.content.buffer);switch(!0){case/^audio\//.test(i.mime):o=t(i.mime,m);break;case/^video\//.test(i.mime):o=n(i.mime,m);break;default:o=!1}return o?e.encode(i):null}function o(i){const o=e.decode(i);if("object"==typeof o&&"mime"in o&&"content"in o&&"string"==typeof o.mime){if("application/json"===o.mime||"text/plain"===o.mime)return"application/json"===o.mime&&"object"==typeof o.content||"text/plain"===o.mime&&"string"==typeof o.content?o:null;let e=!1;const i=new DataView(o.content instanceof ArrayBuffer?o.content:o.content.buffer);switch(!0){case/^audio\//.test(o.mime):e=t(o.mime,i);break;case/^video\//.test(o.mime):e=n(o.mime,i);break;default:e=!1}if(e)return o}return null}export{o as deserialCapsule,i as serialCapsule};
